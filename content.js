snippets.onLoad(function() {
  // Creates a promise to get json data
  const fetchData = (url, options = { method: "get" }) =>
    new Promise((resolve, reject) => {
      let request = new XMLHttpRequest();
      request.onload = resolve;
      request.onerror = reject;
      request.overrideMimeType("application/json");
      request.open(options.method, url, true);
      request.send();
    });

  // Retrieves data and begins creation of HTML cods
  fetchData("./assets/data/dogs.json")
    .then(function(response) {
      // Parses json data
      const dogData = JSON.parse(response.target.response);
      return dogData.dogs;
    })
    .then(function(jsonData) {
      // Calls function to create HTML code
      createImages(jsonData);
      // Removes loading animation
      document.getElementById("site-content__loader").remove();
    })
    .catch(err => {
      console.error(err);
    });

  // Creates and appends images to image container
  function createImages(imgs) {
    for (let i of imgs) {
      const image = document.createElement("img");
      // Adds placeholder image
      image.setAttribute("src", dogSvg);
      // Adds image for the lazy loader to use
      image.setAttribute("data-lazy", i.image);
      // Adds click event for the modal
      image.addEventListener("click", openModal);
      // Adds generic description
      image.setAttribute("alt", "dog image");
      // Creates class selector for the lazy loader
      image.classList.add("lazy-loading");
      document.getElementById("site-content__container").appendChild(image);
    }
    // Sets an observer for each image
    lazyTargets = document.querySelectorAll(".lazy-loading");
    lazyTargets.forEach(lazyLoad);
  }

  // Sets and disconnects lazy load observer
  function lazyLoad(target) {
    // Creates an observer for each element
    const obs = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        // Assigns image src from target when the element comes into view
        if (entry.isIntersecting) {
          const img = entry.target;
          const src = img.getAttribute("data-lazy");
          img.setAttribute("src", src);
          // Adds animation on image load
          img.classList.add("site-content__fadeIn");
          observer.disconnect();
        }
      });
    });
    obs.observe(target);
  }
});

// Opens modal and assigns image src
function openModal(event) {
  const imgSrc = event.target.getAttribute("data-lazy");
  // Displays modal
  document.getElementById("site-content__modal").style.display = "block";
  // Sets the image address
  document
    .getElementById("site-content__modal-img")
    .setAttribute("src", imgSrc);
}

// Closes modal
function closeModal() {
  document.getElementById("site-content__modal").style.display = "none";
}

// Contains svg data to display as placeholder
const dogSvg =
  "data:image/svg+xml,%0A%3Csvg width='128px' height='136px' viewBox='0 0 128 136' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='product-page' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Artboard' transform='translate(-72.000000, -305.000000)'%3E%3Cg id='puppy' transform='translate(72.461031, 305.610486)'%3E%3Cpath d='M87.0389686,119.232395 C94.1912423,111.438422 97.3288058,97.3141375 96.4516593,76.8595426 L26.697624,126.00869 C59.7729135,129.285134 79.886695,127.026369 87.0389686,119.232395 Z' id='Path-4' fill='%23D0CED0'%3E%3C/path%3E%3Cpath d='M91.7867812,88.3834016 L91.2636938,115.85914 C98.4147322,116.938733 102.495402,119.680618 103.505704,124.084796 C105.021157,130.691062 100.081199,132.626588 97.384699,133.720286 C94.6881992,134.813983 87.5354111,135.001515 83.9045324,133.720286 C81.4839465,132.866133 79.6029503,130.616802 78.2615436,126.972292 C75.880316,118.113288 74.2093377,110.215623 73.2486089,103.279299 C72.2878801,96.3429746 71.8910547,89.3113935 72.0581326,82.1845557 C75.9960152,78.6754258 79.9448152,76.410412 83.9045324,75.3895143 C87.8642496,74.3686166 94.810336,73.8247015 104.742792,73.7577689 L114.54147,111.224377 C120.892144,111.157266 124.731032,112.702187 126.058133,115.85914 C128.048784,120.594569 127.179718,124.084796 126.058133,125.192546 C124.936547,126.300296 122.095462,128.625231 117.263425,129.616861 C114.042067,130.277948 110.435289,129.048058 106.44309,125.927192 L99.5389686,115.85914 L91.7867812,88.3834016 Z' id='Path-5' fill='%234A4A4A'%3E%3C/path%3E%3Cpath d='M44.6531029,61.6474755 C41.3909974,65.1073936 39.1628737,67.5523953 37.9687317,68.9824807 C36.7745898,70.412566 35.6910545,71.9335541 34.7181261,73.5454449 C31.9924145,73.7512797 29.5025381,74.3659695 27.2484967,75.3895143 C24.9944554,76.4130592 22.9324876,77.8653309 21.0625933,79.7463296 C16.8097816,76.7669291 13.3823995,71.481324 10.780447,63.8895143 C8.17849451,56.2977047 7.0052642,48.1599388 7.26075607,39.4762166 C0.511617401,48.9722245 -1.5323426,59.5506671 1.12887607,71.2115444 C3.79009474,82.8724217 8.18142333,90.143181 14.3028618,93.0238223 C13.6796349,101.949173 14.4538187,109.048631 16.625413,114.322197 C19.8828044,122.232547 24.0139981,125.114157 28.5940873,127.729074 C31.6474801,129.472352 35.4854096,129.472352 40.1078758,127.729074 C47.6213716,130.994083 53.622052,132.626588 58.1099169,132.626588 C64.8417143,132.626588 67.9052751,131.840102 71.561153,130.814308 C75.217031,129.788514 75.7791922,130.019392 78.2615436,126.972292 C80.7438949,123.925193 79.766208,121.356352 78.9093701,118.634534 C78.0525321,115.912715 75.497066,114.77993 74.2792491,114.322197 C73.0614322,113.864464 69.3060497,113.17914 63.3456444,114.322197 C59.3720409,115.084235 55.5210974,116.521681 51.7928139,118.634534 L55.3687981,108.139018 C59.356229,108.380487 63.6880864,107.489783 68.3643705,105.466904 C75.3787967,102.432585 73.899508,103.53542 81.3513174,96.899432 C86.3191903,92.4754396 90.3459747,87.0109072 93.4316703,80.5058347 L44.6531029,61.6474755 Z' id='Path-3' fill='%234A4A4A'%3E%3C/path%3E%3Cg id='head' transform='translate(18.058133, 0.000000)'%3E%3Cpath d='M51.980836,-7.10542736e-15 C63.8950724,-7.10542736e-15 66.6694842,2.22616065 74.4971087,8.07661614 C77.0927133,4.11504974 79.4553054,1.94384332 81.5848853,1.56299685 C83.7144651,1.18215039 87.6562433,2.2259057 93.4102199,4.69426276 C100.503779,3.2728932 104.806582,4.40034433 106.31863,8.07661614 C108.586703,13.5910239 104.834537,12.115676 101.001233,23.1504402 C97.1679299,34.1852044 94.496834,43.1858254 93.4102199,45.2354959 C92.6858105,46.6019429 90.9200175,47.3440114 88.1128408,47.4617015 L85.1364892,55.9608974 C88.6798647,60.6087647 89.6068113,64.6383847 89.6068113,68.1296978 C89.6068113,70.7359426 87.7962328,75.1161767 81.5848853,77.8110057 C75.3735377,80.5058347 65.5604671,79.1321897 63.0335228,77.8110057 C59.8946754,79.6689149 56.7806566,80.8938723 53.6914663,81.485878 C49.0576808,82.3738866 38.980836,81.485878 34.5356471,77.8110057 C30.0904581,74.1361333 28.914062,67.4736027 29.6393846,65.3240254 C28.7577153,62.5392014 28.0745202,60.9384686 27.0274733,60.521827 C25.456903,59.8968646 24.1905303,62.1001664 20.4227036,61.5330638 C16.6548768,60.9659611 14.8363323,58.8245164 13.0044765,52.0300061 C11.1726207,45.2354959 11.8147815,45.229927 9.65305188,38.8895143 C7.49132225,32.5491016 5.7611994,29.7092207 4.2734939,26.421793 C2.7857884,23.1343653 -2.1448898,18.4957424 1.06430205,14.6723158 C3.20376328,12.1233648 7.18382142,10.8488893 13.0044765,10.8488893 C15.8590037,7.59422149 18.331746,5.54267932 20.4227036,4.69426276 C23.5591399,3.42163793 25.1454508,3.0519177 28.1728071,4.69426276 C30.1910446,5.78915947 31.3893115,7.84070164 31.7676077,10.8488893 C37.300269,3.61629643 44.0380118,-7.10542736e-15 51.980836,-7.10542736e-15 Z' id='Path-2' stroke='%23979797' fill='%239B9B9B'%3E%3C/path%3E%3Cg id='eye' transform='translate(29.480836, 33.389514)'%3E%3Cellipse id='Oval' fill='%23000000' cx='9.5' cy='13.5' rx='9.5' ry='13.5'%3E%3C/ellipse%3E%3Cellipse id='Oval' fill='%23FFFFFF' cx='8.5' cy='8.5' rx='2.5' ry='4.5'%3E%3C/ellipse%3E%3C/g%3E%3Cg id='eye' transform='translate(62.480836, 28.389514)'%3E%3Cellipse id='Oval' fill='%23000000' cx='9.5' cy='13.5' rx='9.5' ry='13.5'%3E%3C/ellipse%3E%3Cellipse id='Oval' fill='%23FFFFFF' cx='6.5' cy='9.5' rx='2.5' ry='4.5'%3E%3C/ellipse%3E%3C/g%3E%3Cg id='nose' transform='translate(42.480836, 52.389514)'%3E%3Cpath d='M7.48874302,2.67465409 C11.9103911,2.2248847 14.7793981,2 16.095764,2 C17.380285,2 20.2393751,2.21413568 24.6730345,2.64240705 L24.6730346,2.64240594 C28.2616311,2.98904807 31,6.00467677 31,9.60997643 L30.9999979,13.4470361 C30.9999979,16.998109 28.3410381,19.986568 24.81406,20.3995376 C21.3952166,20.7998459 19.060721,21 17.810573,21 C16.362323,21 12.905097,20.7313859 7.438895,20.1941578 L7.43889504,20.1941574 C4.11373644,19.8673548 1.48307335,17.2361253 1.15698659,13.9108965 C1.05232886,12.8436624 1,12.1893672 1,11.9480109 C1,11.6588619 1.07510475,10.6799137 1.22531425,9.01116634 L1.22531032,9.01116598 C1.52593059,5.67143523 4.152724,3.01399346 7.48874302,2.67465409 Z' id='Rectangle' fill='%23000000' transform='translate(16.000000, 11.500000) rotate(-5.000000) translate(-16.000000, -11.500000) '%3E%3C/path%3E%3Cellipse id='Oval' fill='%23FFFFFF' transform='translate(16.000000, 11.500000) rotate(-5.000000) translate(-16.000000, -11.500000) ' cx='16' cy='11.5' rx='7' ry='4.5'%3E%3C/ellipse%3E%3C/g%3E%3Cg id='ears' transform='translate(0.000000, 1.486637)' fill='%234A4A4A' stroke='%234A4A4A'%3E%3Cpath d='M87.2306657,45.975065 C86.5836749,45.975065 85.4498305,45.6371443 83.8291328,44.9613029 C81.3980862,43.9475409 80.6188097,43.215205 79.4156447,42.0333174 C78.7817461,41.4106291 76.4000847,33.7327634 75.1184167,25.3618267 C73.9674269,17.844387 73.8312376,9.71067446 74.4971087,6.58997959 C75.3059416,3.20762621 79.5359563,0.442783451 81.5848853,0.0763603014 C83.7144651,-0.304486159 87.6562433,0.739269143 93.4102199,3.20762621 C100.503779,1.78625665 104.806582,2.91370777 106.31863,6.58997959 C108.586703,12.1043873 104.834537,10.6290395 101.001233,21.6638036 C97.1679299,32.6985678 94.496834,41.6991888 93.4102199,43.7488593 C92.6858105,45.1153063 90.9200175,45.8573749 88.1128408,45.975065 L87.2306657,45.975065 Z' id='Path-2'%3E%3C/path%3E%3Cpath d='M27.0959271,58.4698418 C25.9505933,58.9108755 24.1905303,60.6135298 20.4227036,60.0464272 C16.6548768,59.4793246 14.8363323,57.3378798 13.0044765,50.5433696 C11.1726207,43.7488593 11.8147815,43.7432905 9.65305188,37.4028778 C7.49132225,31.0624651 5.7611994,28.2225842 4.2734939,24.9351565 C2.7857884,21.6477287 -2.1448898,17.0091058 1.06430205,13.1856793 C3.20376328,10.6367282 7.18382142,9.36225273 13.0044765,9.36225273 C15.8590037,6.10758494 18.331746,4.05604276 20.4227036,3.20762621 C23.5591399,1.93500138 25.1454508,1.56528115 28.1728071,3.20762621 C30.1910446,4.30252292 31.3893115,6.35406509 31.7676077,9.36225273 L33.3199869,30.4296296 C32.9444954,40.8410517 32.4270356,47.5456317 31.7676077,50.5433696 C30.7784658,55.0399764 28.2412608,58.0288081 27.0959271,58.4698418 Z' id='Path-2'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E";
